import{k as _,u as R,r as l,d as E,l as I,j as e,S as h,L as u,_ as A,B as c,m as C}from"./index-BvEyhJvC.js";import{c as O,d as j}from"./approvalApi-R0l6ihfy.js";import{T as L}from"./editor-DVdwRWap.js";import{A as P}from"./ApprovalSteps-Nfj2jhE1.js";function z(){const{id:n}=_(),v=R(),[a,o]=l.useState(null),[p,m]=l.useState([]),[w,g]=l.useState(!1),[r,N]=l.useState(""),[d,x]=l.useState(null),b=E(I),y={approved:"승인",rejected:"반려",pending:"검토중",standby:"대기중"};l.useEffect(()=>{(async()=>{d&&await O(n,d);const t=await j(n);o(t)})()},[d]),l.useEffect(()=>{(async()=>{const t=await j(n);if(t){if(o(t),t.file){const s=new URL(t.file).pathname,i=s.substring(s.lastIndexOf("/")+1);N(i)}const k=t.review_steps.map(s=>C(s.reviewer.id).then(i=>({id:i.id,name:i.name,department:i.department.name,profile_image:i.profile_image,status:y[s.status]}))),f=await Promise.all(k);g(f.some(s=>s.id===b.id&&s.status==="검토중")),m(f)}})()},[n,a]);const S=()=>{v(-1)};return a?e.jsx(h,{children:e.jsx(u,{children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"flex bg-white rounded-lg shadow-lg overflow-hidden transition-all w-10/12 min-w-[1100px] h-full",children:e.jsxs("div",{className:"flex flex-row w-full h-full",children:[e.jsx("div",{className:"flex-grow p-8 px-14 overflow-auto border-r-2 border-gray-200",children:e.jsxs("div",{className:"overflow-y-auto max-h-full h-full flex flex-col justify-between hide-scrollbar",children:[e.jsxs("div",{className:"flex justify-between mt-3",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-1",children:"결재 문서"}),e.jsx("div",{className:"mx-1",children:e.jsx(c,{text:"뒤로가기",onClick:S})})]}),e.jsxs("div",{className:"flex my-3",children:[e.jsx("h3",{className:"text-xl font-semibold mr-4",children:"제목"}),e.jsx("div",{className:"text-xl",children:a.title})]}),a.file&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-l font-semibold mt-1",children:"파일 첨부"}),e.jsx("div",{className:"bg-gray-100 p-5 mt-5 rounded-lg",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsx("div",{children:e.jsxs("a",{className:"flex items-center space-x-4 bg-white p-4 rounded-lg shadow-md",href:a.file,download:a.file,target:"_blank",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 bg-orange-200 rounded-lg flex items-center justify-center",children:e.jsx("img",{src:`https://img.icons8.com/color/48/000000/${r.substring(r.lastIndexOf(".")+1)==="jpeg"?"jpg":r.substring(r.lastIndexOf(".")+1)}.png`,alt:"doc",className:"w-6 h-6"})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:decodeURIComponent(r)})}),e.jsx("div",{className:"cursor-pointer"})]})})})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-l font-semibold mt-5 mb-3",children:"문서 양식"}),e.jsx(L,{value:a.content,readOnly:!0,modules:{toolbar:!1}})]}),e.jsx("div",{children:w&&e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"mx-1",children:e.jsx(c,{text:"반려",onClick:()=>{x("rejected")}})}),e.jsx("div",{className:"mx-1",children:e.jsx(c,{variant:"teams",text:"승인",onClick:()=>{x("approved")}})})]})})]})}),e.jsx("div",{className:"w-80 p-6 bg-white border-r flex-shrink-0 h-full overflow-auto",children:e.jsx(P,{data:p,setData:m,isEditable:!1})})]})})})})}):e.jsx(h,{children:e.jsx(u,{children:e.jsx("div",{className:"flex w-full justify-center items-center m-auto w-1/2 h-full p-72",children:e.jsx(A,{color:"#5d5bd4",size:70,"aria-label":"Loading Spinner","data-testid":"loader"})})})})}export{z as default};
