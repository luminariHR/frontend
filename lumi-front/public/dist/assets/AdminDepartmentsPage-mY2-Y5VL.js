import{r as n,j as e,S as L,L as B,C as F,B as r,_ as P,t as N,v as q,w as z,x as H}from"./index-BvEyhJvC.js";import{I as o}from"./input-D1N2lLD0.js";import{T as R,a as G,b as w,c as i,d as J,e as c}from"./table-D9qS8Jup.js";/* empty css                         */import{C as b}from"./modal-CjDEBRy-.js";import{C as g}from"./select-DrmS5N3L.js";import"./index-D8Hp-Fll.js";function $(){const[K,_]=n.useState(new Date),[d,u]=n.useState([]),[t,p]=n.useState(null),[S,m]=n.useState(!1),[l,j]=n.useState(null),[y,x]=n.useState(!1),[f,E]=n.useState(""),[v,O]=n.useState(""),[C,T]=n.useState(!0),D=async()=>{const s=await N();s&&u(s.sort((a,h)=>a.id-h.id))};n.useEffect(()=>{(async()=>{const a=await N();a&&u(a.sort((h,I)=>h.id-I.id)),T(!1)})()},[]),n.useEffect(()=>{let s;const a=()=>{_(new Date),s=requestAnimationFrame(a)};return s=requestAnimationFrame(a),()=>cancelAnimationFrame(s)},[]);const M=s=>{p(s),j(d.find(a=>a.department_id===s.parent_department_id)),m(!0)},A=async()=>{const s={department_id:t.department_id,name:t.name,address:t.address,parent_department_id:l?l.department_id:null};try{const a=await q(t.id,s);alert(a.message),m(!1),D()}catch(a){console.error("Error updating department:",a),alert("부서 수정 중 오류가 발생했습니다.")}},k=async()=>{const s={department_id:z(d),name:f,address:v,parent_department_id:l?l.department_id:null};try{const a=await H(s);alert(a.message),x(!1),D()}catch(a){console.error("Error creating department:",a),alert("부서 생성 중 오류가 발생했습니다.")}};return e.jsxs(L,{children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex flex-row justify-between mb-6",children:[e.jsxs("h2",{children:[e.jsx("span",{className:"text-[#8a8686]",children:"메인 > 인사 관리 >"})," ",e.jsx("span",{className:"font-semibold text-[#20243f]",children:"부서 관리"})]}),e.jsxs("h2",{className:"flex",children:[e.jsx("span",{children:e.jsx(F,{className:"text-gray-500 h-[20px]"})}),e.jsx("span",{className:"text-gray-500 ml-2 text-[14px]",children:"업무 외 개인정보 이용 금지"})]})]}),e.jsxs("div",{className:"mx-16",children:[e.jsx("div",{className:"mb-3 flex items-center justify-end",children:e.jsx(r,{text:"부서 생성하기",variant:"teams",onClick:()=>{x(!0)}})}),e.jsx("div",{className:"overflow-auto rounded-lg h-[63vh] hide-scrollbar",children:C?e.jsx("div",{className:"flex w-full justify-center items-center m-auto w-1/2 p-8",children:e.jsx(P,{color:"#5d5bd4",loading:C,size:50,"aria-label":"Loading Spinner","data-testid":"loader"})}):e.jsxs(R,{children:[e.jsx(G,{children:e.jsxs(w,{children:[e.jsx(i,{children:"번호"}),e.jsx(i,{children:"부서명"}),e.jsx(i,{children:"부서장"}),e.jsx(i,{children:"상위부서"}),e.jsx(i,{children:"주소"}),e.jsx(i,{})]})}),e.jsx(J,{children:d.map(s=>e.jsxs(w,{children:[e.jsx(c,{children:s.id}),e.jsx(c,{children:s.name?s.name:"-"}),e.jsx(c,{children:s.head?s.head.name:"-"}),e.jsx(c,{children:s.parent_department_id?d.find(a=>a.department_id===s.parent_department_id).name:"-"}),e.jsx(c,{children:s.address?s.address:"-"}),e.jsx(c,{children:e.jsx("div",{className:"w-full flex justify-end",children:e.jsx(r,{addClass:"mr-2",size:"sm",text:"수정",onClick:()=>M(s)})})})]},s.id))})]})})]})]}),e.jsxs(b,{isOpen:S,closeModal:()=>m(!1),title:"부서 정보 수정",children:[e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mb-2",children:"부서명"}),e.jsx(o,{addClass:"w-full text-sm",value:t?t.name:"",onChange:s=>p({...t,name:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2",children:"부서장"}),e.jsx(o,{addClass:"w-full text-sm",value:t&&t.head?t.head.name:"-",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2",children:"상위부서"}),e.jsx(g,{options:d,selectedOption:l,onSelect:j,defaultText:"상위부서를 선택하세요."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2",children:"주소"}),e.jsx(o,{addClass:"w-full text-sm",value:t?t.address:"",onChange:s=>p({...t,address:s.target.value})})]})]}),e.jsxs("div",{className:"flex justify-center pt-8",children:[e.jsx(r,{addClass:"mr-2",text:"취소",variant:"default",onClick:()=>{m(!1)}}),e.jsx(r,{text:"저장하기",variant:"solid",onClick:A})]})]}),e.jsxs(b,{isOpen:y,closeModal:()=>x(!1),title:"신규 부서 생성",children:[e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mb-2",children:"부서명"}),e.jsx(o,{addClass:"w-full text-sm",value:f,onChange:s=>E(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2",children:"상위부서"}),e.jsx(g,{options:d,selectedOption:l,onSelect:j,defaultText:"상위부서를 선택하세요."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2",children:"주소"}),e.jsx(o,{addClass:"w-full text-sm",value:v,onChange:s=>O(s.target.value)})]})]}),e.jsxs("div",{className:"flex justify-center pt-8",children:[e.jsx(r,{addClass:"mr-2",text:"취소",variant:"default",onClick:()=>{x(!1)}}),e.jsx(r,{text:"저장하기",variant:"solid",onClick:k})]})]})]})}export{$ as default};
