import{a as G,r as n,j as e,S as J,L as K,C as Q,B as c,_ as V,U as W,n as b,E as X,t as Y}from"./index-BvEyhJvC.js";import{I as i}from"./input-D1N2lLD0.js";import{T as Z,a as ee,b as k,c as o,d as se,e as m}from"./table-D9qS8Jup.js";import{C as y}from"./modal-CjDEBRy-.js";import{C as S}from"./select-DrmS5N3L.js";import"./index-D8Hp-Fll.js";const ae=async v=>{try{const d=await G.post("/admin/appointments/",v);return console.log("app response",d),d.data}catch(d){throw console.error("Error posting appointment:",d),d}};function ce(){const[v,d]=n.useState(new Date),[D,j]=n.useState([]),[I,E]=n.useState([]),[g,T]=n.useState(""),[A,C]=n.useState(!1),[M,_]=n.useState(!1),[t,x]=n.useState(null),[r,N]=n.useState({first_name:"",last_name:"",email:"",employee_id:"",gender:0,employment_status:0,job_title:"",phone_number:"",start_date:""}),[w,O]=n.useState(!0),F=s=>{x({...s,is_department_head:s.is_department_head}),C(!0)},u=()=>{C(!1),x(null)},L=s=>{const{name:a,value:l}=s.target;x(f=>({...f,[a]:l}))},h=s=>{const{name:a,value:l}=s.target;N(f=>({...f,[a]:l}))},U=s=>{x(a=>({...a,department:s}))},B=s=>{N(a=>({...a,gender:s.id}))},P=s=>{x(a=>({...a,is_department_head:s.target.checked}))},z=async()=>{const s={employee_id:t.id,new_department_id:t.department.id,new_job_title:t.job_title,is_department_head:t.is_department_head};try{const a=await ae(s);if(a){alert(a.message);const l=await b();j(l),u()}}catch(a){console.error("Error saving appointment:",a),alert("인사 발령 중 오류가 발생했습니다.")}},q=()=>{_(!0)},p=()=>{_(!1)},H=async()=>{try{const s={...r,employee_id:`EMP${Date.now()}`,start_date:new Date().toISOString().split("T")[0]},a=await X(s);if(a){alert(a.message);const l=await b();j(l),p()}}catch(s){console.error("Error inviting user:",s),alert("회원 초대 중 오류가 발생했습니다.")}};n.useEffect(()=>{(async()=>{const a=await b(),l=await Y();a&&j(a),l&&E(l),O(!1)})()},[]),n.useEffect(()=>{let s;const a=()=>{d(new Date),s=requestAnimationFrame(a)};return s=requestAnimationFrame(a),()=>cancelAnimationFrame(s)},[]);const R=s=>{T(s.target.value)},$=D.filter(s=>s.name.toLowerCase().includes(g.toLowerCase()));return e.jsx(J,{children:e.jsxs(K,{children:[e.jsxs("div",{className:"flex flex-row justify-between mb-6",children:[e.jsxs("h2",{children:[e.jsx("span",{className:"text-[#8a8686]",children:"메인 > 인사 관리 >"})," ",e.jsx("span",{className:"font-semibold text-[#20243f]",children:"인사 발령"})]}),e.jsxs("h2",{className:"flex",children:[e.jsx("span",{children:e.jsx(Q,{className:"text-gray-500 h-[20px]"})}),e.jsx("span",{className:"text-gray-500 ml-2 text-[14px]",children:"업무 외 개인정보 이용 금지"})]})]}),e.jsxs("div",{className:"mx-16",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between hide-scrollbar",children:[e.jsx(i,{placeholder:"이름을 입력하세요.",value:g,onChange:R}),e.jsx("div",{children:e.jsx(c,{text:"신규 회원 초대",variant:"teams",onClick:q,addClass:"font-semibold"})})]}),e.jsx("div",{className:"overflow-auto rounded-lg ",children:w?e.jsx("div",{className:"flex w-full justify-center items-center m-auto w-1/2 p-8",children:e.jsx(V,{color:"#5d5bd4",loading:w,size:50,"aria-label":"Loading Spinner","data-testid":"loader"})}):e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(k,{children:[e.jsx(o,{children:"이름"}),e.jsx(o,{}),e.jsx(o,{children:"이메일"}),e.jsx(o,{children:"직책"}),e.jsx(o,{children:"부서"}),e.jsx(o,{})]})}),e.jsx(se,{children:$.map(s=>e.jsxs(k,{addClass:"cursor-default",children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-6 w-6 flex-shrink-0",children:e.jsx(W,{userProfileImg:s.profile_image,userName:s.name})}),e.jsx("div",{className:"ml-2",children:s.name})]})}),e.jsx(m,{}),e.jsx(m,{children:s.email}),e.jsx(m,{children:s.job_title}),e.jsx(m,{children:s.department?s.department.name:"-"}),e.jsx(m,{addClass:"flex justify-end",children:e.jsx(c,{text:"인사 발령",size:"sm",onClick:()=>F(s)})})]},s.id))})]})})]}),e.jsx(y,{isOpen:A,closeModal:u,title:"인사 발령",children:t&&e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-2",children:"이름"}),e.jsx(i,{name:"name",value:t.name,addClass:"w-full text-sm",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-2",children:"이메일"}),e.jsx(i,{name:"email",value:t.email,addClass:"w-full text-sm",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-2",children:"부서"}),e.jsx(S,{options:I,selectedOption:t.department,onSelect:U,defaultText:"부서를 선택하세요"}),e.jsx("div",{className:"h-9 flex items-center",children:e.jsxs("label",{className:"flex items-center ml-1 text-xs",children:[e.jsx("input",{type:"checkbox",name:"is_head",checked:t.is_department_head,onChange:P,className:"mr-2 h-4 w-4 rounded-lg checked:rounded-lg",style:{backgroundImage:`url(${t.is_department_head?"src/assets/checkbox-checked.png":"src/assets/checkbox.png"})`,backgroundSize:"cover"}}),e.jsx("span",{className:"font-semibold",children:"이 직원을 부서장으로 지정"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-2",children:"직책"}),e.jsx(i,{name:"job_title",value:t.job_title,onChange:L,addClass:"w-full text-sm"})]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-4",children:[e.jsx(c,{text:"취소",onClick:u}),e.jsx(c,{text:"저장",variant:"primary",onClick:z})]})]})}),e.jsx(y,{isOpen:M,closeModal:p,title:"신규 회원 초대",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-2",children:"성"}),e.jsx(i,{name:"last_name",value:r.last_name,onChange:h,addClass:"w-full text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-2",children:"이름"}),e.jsx(i,{name:"first_name",value:r.first_name,onChange:h,addClass:"w-full text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-2",children:"이메일"}),e.jsx(i,{name:"email",value:r.email,onChange:h,addClass:"w-full text-sm"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-2",children:"성별"}),e.jsx(S,{options:[{id:0,name:"남자"},{id:1,name:"여자"}],selectedOption:r.gender===0?{id:0,name:"남자"}:r.gender===1?{id:1,name:"여자"}:null,onSelect:B,defaultText:"성별을 선택하세요"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-2",children:"휴대전화"}),e.jsx(i,{name:"phone_number",value:r.phone_number,onChange:h,addClass:"w-full text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-2",children:"직책"}),e.jsx(i,{name:"job_title",value:r.job_title,onChange:h,addClass:"w-full text-sm"})]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-4",children:[e.jsx(c,{text:"취소",onClick:p}),e.jsx(c,{text:"초대 이메일 전송",variant:"teams",onClick:H})]})]})})]})})}export{ce as default};
